
#include <gtest/gtest.h>

#include <gmock/gmock.h>

#include <geometry/intersection.h>

#include <geometry/linesegment.h>

using ::testing::UnorderedElementsAreArray;


std::vector<PointR> getIntersectionsBrute(const std::vector<LineSegmentR>& lines) 
{
	std::vector<PointR> intersections;

	for (size_t i = 0; i < lines.size(); ++i) 
	{
		for (size_t j = i + 1; j < lines.size(); ++j) {
			std::optional<PointR> intersection = lines[i].intersects(lines[j]);
			if (intersection) 
				intersections.push_back(intersection.value());
			
		}
	}

	return intersections;
}


TEST(bentleyOttmann, TestIsectBowtie01) {
std::vector<LineSegmentR> lines = {
LineSegmentR({Rational(-1,1),Rational(1,1)},{Rational(1,1),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-1,1)},{Rational(-1,1),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-1,1)},{Rational(1,1),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(1,1)},{Rational(-1,1),Rational(1,1)}),
};
std::vector<PointR> intersections = getIntersectionsBrute(lines);
auto events = bentleyOttmann(lines);
std::vector<PointR> results;
for (const auto& event : events)
	results.push_back(event.first);
EXPECT_THAT(results, UnorderedElementsAreArray(intersections));
}

TEST(bentleyOttmann, TestIsectBowtieCircle01) {
std::vector<LineSegmentR> lines = {
LineSegmentR({Rational(0,1),Rational(9,10)},{Rational(73499,500000),Rational(882707,1000000)}),
LineSegmentR({Rational(1097,4000),Rational(207873,250000)},{Rational(364257,1000000),Rational(748323,1000000)}),
LineSegmentR({Rational(364257,1000000),Rational(748323,1000000)},{Rational(201903,500000),Rational(636397,1000000)}),
LineSegmentR({Rational(201903,500000),Rational(636397,1000000)},{Rational(96397,250000),Rational(250007,500000)}),
LineSegmentR({Rational(96397,250000),Rational(250007,500000)},{Rational(154619,500000),Rational(10763,31250)}),
LineSegmentR({Rational(154619,500000),Rational(10763,31250)},{Rational(181693,1000000),Rational(87791,500000)}),
LineSegmentR({Rational(181693,1000000),Rational(87791,500000)},{Rational(16817,1000000),Rational(1,1000000)}),
LineSegmentR({Rational(16817,1000000),Rational(1,1000000)},{Rational(-165673,1000000),Rational(-175581,1000000)}),
LineSegmentR({Rational(-165673,1000000),Rational(-175581,1000000)},{Rational(-341921,1000000),Rational(-172207,500000)}),
LineSegmentR({Rational(-341921,1000000),Rational(-172207,500000)},{Rational(-60763,125000),Rational(-500013,1000000)}),
LineSegmentR({Rational(-60763,125000),Rational(-500013,1000000)},{Rational(-114581,200000),Rational(-159099,250000)}),
LineSegmentR({Rational(-114581,200000),Rational(-159099,250000)},{Rational(-290023,500000),Rational(-374161,500000)}),
LineSegmentR({Rational(-290023,500000),Rational(-374161,500000)},{Rational(-12267,25000),Rational(-831491,1000000)}),
LineSegmentR({Rational(-12267,25000),Rational(-831491,1000000)},{Rational(-73883,250000),Rational(-882707,1000000)}),
LineSegmentR({Rational(-73883,250000),Rational(-882707,1000000)},{Rational(0,1),Rational(-9,10)}),
LineSegmentR({Rational(0,1),Rational(-9,10)},{Rational(295533,1000000),Rational(-882707,1000000)}),
LineSegmentR({Rational(295533,1000000),Rational(-882707,1000000)},{Rational(12267,25000),Rational(-207873,250000)}),
LineSegmentR({Rational(12267,25000),Rational(-207873,250000)},{Rational(580047,1000000),Rational(-748323,1000000)}),
LineSegmentR({Rational(580047,1000000),Rational(-748323,1000000)},{Rational(286453,500000),Rational(-159099,250000)}),
LineSegmentR({Rational(286453,500000),Rational(-159099,250000)},{Rational(97221,200000),Rational(-500013,1000000)}),
LineSegmentR({Rational(97221,200000),Rational(-500013,1000000)},{Rational(170961,500000),Rational(-68883,200000)}),
LineSegmentR({Rational(170961,500000),Rational(-68883,200000)},{Rational(82837,500000),Rational(-175581,1000000)}),
LineSegmentR({Rational(82837,500000),Rational(-175581,1000000)},{Rational(-16817,1000000),Rational(0,1)}),
LineSegmentR({Rational(-16817,1000000),Rational(0,1)},{Rational(-45423,250000),Rational(175581,1000000)}),
LineSegmentR({Rational(-45423,250000),Rational(175581,1000000)},{Rational(-309237,1000000),Rational(68883,200000)}),
LineSegmentR({Rational(-309237,1000000),Rational(68883,200000)},{Rational(-96397,250000),Rational(500013,1000000)}),
LineSegmentR({Rational(-96397,250000),Rational(500013,1000000)},{Rational(-201903,500000),Rational(159099,250000)}),
LineSegmentR({Rational(-201903,500000),Rational(159099,250000)},{Rational(-364257,1000000),Rational(748323,1000000)}),
LineSegmentR({Rational(-364257,1000000),Rational(748323,1000000)},{Rational(-274251,1000000),Rational(207873,250000)}),
LineSegmentR({Rational(-274251,1000000),Rational(207873,250000)},{Rational(-146999,1000000),Rational(882707,1000000)}),
LineSegmentR({Rational(-146999,1000000),Rational(882707,1000000)},{Rational(0,1),Rational(9,10)}),
LineSegmentR({Rational(73499,500000),Rational(882707,1000000)},{Rational(1097,4000),Rational(207873,250000)}),
LineSegmentR({Rational(-192457,1000000),Rational(196157,200000)},{Rational(0,1),Rational(1,1)}),
LineSegmentR({Rational(-180491,500000),Rational(23097,25000)},{Rational(-192457,1000000),Rational(196157,200000)}),
LineSegmentR({Rational(-484309,1000000),Rational(83147,100000)},{Rational(-180491,500000),Rational(23097,25000)}),
LineSegmentR({Rational(-273127,500000),Rational(707107,1000000)},{Rational(-484309,1000000),Rational(83147,100000)}),
LineSegmentR({Rational(-16801,31250),Rational(55557,100000)},{Rational(-273127,500000),Rational(707107,1000000)}),
LineSegmentR({Rational(-457507,1000000),Rational(382683,1000000)},{Rational(-16801,31250),Rational(55557,100000)}),
LineSegmentR({Rational(-39203,125000),Rational(19509,100000)},{Rational(-457507,1000000),Rational(382683,1000000)}),
LineSegmentR({Rational(-24399,200000),Rational(0,1)},{Rational(-39203,125000),Rational(19509,100000)}),
LineSegmentR({Rational(47183,500000),Rational(-19509,100000)},{Rational(-24399,200000),Rational(0,1)}),
LineSegmentR({Rational(30743,100000),Rational(-382683,1000000)},{Rational(47183,500000),Rational(-19509,100000)}),
LineSegmentR({Rational(48671,100000),Rational(-55557,100000)},{Rational(30743,100000),Rational(-382683,1000000)}),
LineSegmentR({Rational(301081,500000),Rational(-707107,1000000)},{Rational(48671,100000),Rational(-55557,100000)}),
LineSegmentR({Rational(627167,1000000),Rational(-83147,100000)},{Rational(301081,500000),Rational(-707107,1000000)}),
LineSegmentR({Rational(541323,1000000),Rational(-23097,25000)},{Rational(627167,1000000),Rational(-83147,100000)}),
LineSegmentR({Rational(83199,250000),Rational(-196157,200000)},{Rational(541323,1000000),Rational(-23097,25000)}),
LineSegmentR({Rational(0,1),Rational(-1,1)},{Rational(83199,250000),Rational(-196157,200000)}),
LineSegmentR({Rational(-83199,250000),Rational(-196157,200000)},{Rational(0,1),Rational(-1,1)}),
LineSegmentR({Rational(-270661,500000),Rational(-923879,1000000)},{Rational(-83199,250000),Rational(-196157,200000)}),
LineSegmentR({Rational(-313583,500000),Rational(-831469,1000000)},{Rational(-270661,500000),Rational(-923879,1000000)}),
LineSegmentR({Rational(-602161,1000000),Rational(-353553,500000)},{Rational(-313583,500000),Rational(-831469,1000000)}),
LineSegmentR({Rational(-486709,1000000),Rational(-55557,100000)},{Rational(-602161,1000000),Rational(-353553,500000)}),
LineSegmentR({Rational(-307429,1000000),Rational(-382683,1000000)},{Rational(-486709,1000000),Rational(-55557,100000)}),
LineSegmentR({Rational(-47183,500000),Rational(-195089,1000000)},{Rational(-307429,1000000),Rational(-382683,1000000)}),
LineSegmentR({Rational(30499,250000),Rational(1,1000000)},{Rational(-47183,500000),Rational(-195089,1000000)}),
LineSegmentR({Rational(2509,8000),Rational(195091,1000000)},{Rational(30499,250000),Rational(1,1000000)}),
LineSegmentR({Rational(457507,1000000),Rational(95671,250000)},{Rational(2509,8000),Rational(195091,1000000)}),
LineSegmentR({Rational(537633,1000000),Rational(555571,1000000)},{Rational(457507,1000000),Rational(95671,250000)}),
LineSegmentR({Rational(273127,500000),Rational(176777,250000)},{Rational(537633,1000000),Rational(555571,1000000)}),
LineSegmentR({Rational(484309,1000000),Rational(83147,100000)},{Rational(273127,500000),Rational(176777,250000)}),
LineSegmentR({Rational(360981,1000000),Rational(23097,25000)},{Rational(484309,1000000),Rational(83147,100000)}),
LineSegmentR({Rational(24057,125000),Rational(490393,500000)},{Rational(360981,1000000),Rational(23097,25000)}),
LineSegmentR({Rational(0,1),Rational(1,1)},{Rational(24057,125000),Rational(490393,500000)}),
LineSegmentR({Rational(0,1),Rational(81,100)},{Rational(55539,500000),Rational(198609,250000)}),
LineSegmentR({Rational(102951,500000),Rational(748343,1000000)},{Rational(270113,1000000),Rational(673491,1000000)}),
LineSegmentR({Rational(270113,1000000),Rational(673491,1000000)},{Rational(146483,500000),Rational(572757,1000000)}),
LineSegmentR({Rational(146483,500000),Rational(572757,1000000)},{Rational(134343,500000),Rational(450013,1000000)}),
LineSegmentR({Rational(134343,500000),Rational(450013,1000000)},{Rational(197343,1000000),Rational(154987,500000)}),
LineSegmentR({Rational(197343,1000000),Rational(154987,500000)},{Rational(42569,500000),Rational(19753,125000)}),
LineSegmentR({Rational(42569,500000),Rational(19753,125000)},{Rational(-13981,250000),Rational(1,1000000)}),
LineSegmentR({Rational(-13981,250000),Rational(1,1000000)},{Rational(-104483,500000),Rational(-79011,500000)}),
LineSegmentR({Rational(-104483,500000),Rational(-79011,500000)},{Rational(-11053,31250),Rational(-309973,1000000)}),
LineSegmentR({Rational(-11053,31250),Rational(-309973,1000000)},{Rational(-234137,500000),Rational(-450011,1000000)}),
LineSegmentR({Rational(-234137,500000),Rational(-450011,1000000)},{Rational(-26571,50000),Rational(-143189,250000)}),
LineSegmentR({Rational(-26571,50000),Rational(-143189,250000)},{Rational(-131151,250000),Rational(-67349,100000)}),
LineSegmentR({Rational(-131151,250000),Rational(-67349,100000)},{Rational(-108561,250000),Rational(-374171,500000)}),
LineSegmentR({Rational(-108561,250000),Rational(-374171,500000)},{Rational(-254567,1000000),Rational(-198609,250000)}),
LineSegmentR({Rational(-254567,1000000),Rational(-198609,250000)},{Rational(0,1),Rational(-81,100)}),
LineSegmentR({Rational(0,1),Rational(-81,100)},{Rational(31821,125000),Rational(-198609,250000)}),
LineSegmentR({Rational(31821,125000),Rational(-198609,250000)},{Rational(86849,200000),Rational(-748343,1000000)}),
LineSegmentR({Rational(86849,200000),Rational(-748343,1000000)},{Rational(104921,200000),Rational(-67349,100000)}),
LineSegmentR({Rational(104921,200000),Rational(-67349,100000)},{Rational(26571,50000),Rational(-572757,1000000)}),
LineSegmentR({Rational(26571,50000),Rational(-572757,1000000)},{Rational(18731,40000),Rational(-112503,250000)}),
LineSegmentR({Rational(18731,40000),Rational(-112503,250000)},{Rational(353697,1000000),Rational(-309973,1000000)}),
LineSegmentR({Rational(353697,1000000),Rational(-309973,1000000)},{Rational(208967,1000000),Rational(-158023,1000000)}),
LineSegmentR({Rational(208967,1000000),Rational(-158023,1000000)},{Rational(2237,40000),Rational(0,1)}),
LineSegmentR({Rational(2237,40000),Rational(0,1)},{Rational(-85137,1000000),Rational(158023,1000000)}),
LineSegmentR({Rational(-85137,1000000),Rational(158023,1000000)},{Rational(-98671,500000),Rational(154987,500000)}),
LineSegmentR({Rational(-98671,500000),Rational(154987,500000)},{Rational(-53737,200000),Rational(112503,250000)}),
LineSegmentR({Rational(-53737,200000),Rational(112503,250000)},{Rational(-146483,500000),Rational(572757,1000000)}),
LineSegmentR({Rational(-146483,500000),Rational(572757,1000000)},{Rational(-270113,1000000),Rational(67349,100000)}),
LineSegmentR({Rational(-270113,1000000),Rational(67349,100000)},{Rational(-205903,1000000),Rational(374171,500000)}),
LineSegmentR({Rational(-205903,1000000),Rational(374171,500000)},{Rational(-111079,1000000),Rational(198609,250000)}),
LineSegmentR({Rational(-111079,1000000),Rational(198609,250000)},{Rational(0,1),Rational(81,100)}),
LineSegmentR({Rational(55539,500000),Rational(198609,250000)},{Rational(102951,500000),Rational(748343,1000000)}),
LineSegmentR({Rational(0,1),Rational(729,1000)},{Rational(10349,125000),Rational(714993,1000000)}),
LineSegmentR({Rational(1903,12500),Rational(673509,1000000)},{Rational(983,5000),Rational(303071,500000)}),
LineSegmentR({Rational(983,5000),Rational(303071,500000)},{Rational(103583,500000),Rational(257741,500000)}),
LineSegmentR({Rational(103583,500000),Rational(257741,500000)},{Rational(179421,1000000),Rational(405011,1000000)}),
LineSegmentR({Rational(179421,1000000),Rational(405011,1000000)},{Rational(28439,250000),Rational(278977,1000000)}),
LineSegmentR({Rational(28439,250000),Rational(278977,1000000)},{Rational(1963,125000),Rational(71111,500000)}),
LineSegmentR({Rational(1963,125000),Rational(71111,500000)},{Rational(-104347,1000000),Rational(1,1000000)}),
LineSegmentR({Rational(-104347,1000000),Rational(1,1000000)},{Rational(-46393,200000),Rational(-7111,50000)}),
LineSegmentR({Rational(-46393,200000),Rational(-7111,50000)},{Rational(-174959,500000),Rational(-4359,15625)}),
LineSegmentR({Rational(-174959,500000),Rational(-4359,15625)},{Rational(-54973,125000),Rational(-40501,100000)}),
LineSegmentR({Rational(-54973,125000),Rational(-40501,100000)},{Rational(-19351,40000),Rational(-515481,1000000)}),
LineSegmentR({Rational(-19351,40000),Rational(-515481,1000000)},{Rational(-466701,1000000),Rational(-606141,1000000)}),
LineSegmentR({Rational(-466701,1000000),Rational(-606141,1000000)},{Rational(-378187,1000000),Rational(-168377,250000)}),
LineSegmentR({Rational(-378187,1000000),Rational(-168377,250000)},{Rational(-216469,1000000),Rational(-44687,62500)}),
LineSegmentR({Rational(-216469,1000000),Rational(-44687,62500)},{Rational(0,1),Rational(-729,1000)}),
LineSegmentR({Rational(0,1),Rational(-729,1000)},{Rational(21647,100000),Rational(-714993,1000000)}),
LineSegmentR({Rational(21647,100000),Rational(-714993,1000000)},{Rational(94547,250000),Rational(-168377,250000)}),
LineSegmentR({Rational(94547,250000),Rational(-168377,250000)},{Rational(233351,500000),Rational(-606141,1000000)}),
LineSegmentR({Rational(233351,500000),Rational(-606141,1000000)},{Rational(7559,15625),Rational(-515481,1000000)}),
LineSegmentR({Rational(7559,15625),Rational(-515481,1000000)},{Rational(87957,200000),Rational(-405011,1000000)}),
LineSegmentR({Rational(87957,200000),Rational(-405011,1000000)},{Rational(349919,1000000),Rational(-4359,15625)}),
LineSegmentR({Rational(349919,1000000),Rational(-4359,15625)},{Rational(115983,500000),Rational(-142221,1000000)}),
LineSegmentR({Rational(115983,500000),Rational(-142221,1000000)},{Rational(26087,250000),Rational(0,1)}),
LineSegmentR({Rational(26087,250000),Rational(0,1)},{Rational(-15703,1000000),Rational(142221,1000000)}),
LineSegmentR({Rational(-15703,1000000),Rational(142221,1000000)},{Rational(-22751,200000),Rational(4359,15625)}),
LineSegmentR({Rational(-22751,200000),Rational(4359,15625)},{Rational(-179421,1000000),Rational(405011,1000000)}),
LineSegmentR({Rational(-179421,1000000),Rational(405011,1000000)},{Rational(-103583,500000),Rational(515481,1000000)}),
LineSegmentR({Rational(-103583,500000),Rational(515481,1000000)},{Rational(-196599,1000000),Rational(606141,1000000)}),
LineSegmentR({Rational(-196599,1000000),Rational(606141,1000000)},{Rational(-1903,12500),Rational(168377,250000)}),
LineSegmentR({Rational(-1903,12500),Rational(168377,250000)},{Rational(-10349,125000),Rational(714993,1000000)}),
LineSegmentR({Rational(-10349,125000),Rational(714993,1000000)},{Rational(0,1),Rational(729,1000)}),
LineSegmentR({Rational(10349,125000),Rational(714993,1000000)},{Rational(1903,12500),Rational(673509,1000000)}),
LineSegmentR({Rational(0,1),Rational(6561,10000)},{Rational(30303,500000),Rational(643493,1000000)}),
LineSegmentR({Rational(110291,1000000),Rational(303079,500000)},{Rational(139481,1000000),Rational(68191,125000)}),
LineSegmentR({Rational(139481,1000000),Rational(68191,125000)},{Rational(141157,1000000),Rational(463933,1000000)}),
LineSegmentR({Rational(141157,1000000),Rational(463933,1000000)},{Rational(55911,500000),Rational(36451,100000)}),
LineSegmentR({Rational(55911,500000),Rational(36451,100000)},{Rational(52097,1000000),Rational(251079,1000000)}),
LineSegmentR({Rational(52097,1000000),Rational(251079,1000000)},{Rational(-33089,1000000),Rational(127999,1000000)}),
LineSegmentR({Rational(-33089,1000000),Rational(127999,1000000)},{Rational(-134761,1000000),Rational(1,1000000)}),
LineSegmentR({Rational(-134761,1000000),Rational(1,1000000)},{Rational(-120297,500000),Rational(-63999,500000)}),
LineSegmentR({Rational(-120297,500000),Rational(-63999,500000)},{Rational(-335997,1000000),Rational(-125539,500000)}),
LineSegmentR({Rational(-335997,1000000),Rational(-125539,500000)},{Rational(-405497,1000000),Rational(-364509,1000000)}),
LineSegmentR({Rational(-405497,1000000),Rational(-364509,1000000)},{Rational(-86871,200000),Rational(-463933,1000000)}),
LineSegmentR({Rational(-86871,200000),Rational(-463933,1000000)},{Rational(-410377,1000000),Rational(-545527,1000000)}),
LineSegmentR({Rational(-410377,1000000),Rational(-545527,1000000)},{Rational(-65239,200000),Rational(-606157,1000000)}),
LineSegmentR({Rational(-65239,200000),Rational(-606157,1000000)},{Rational(-183247,1000000),Rational(-643493,1000000)}),
LineSegmentR({Rational(-183247,1000000),Rational(-643493,1000000)},{Rational(0,1),Rational(-6561,10000)}),
LineSegmentR({Rational(0,1),Rational(-6561,10000)},{Rational(11453,62500),Rational(-643493,1000000)}),
LineSegmentR({Rational(11453,62500),Rational(-643493,1000000)},{Rational(81549,250000),Rational(-303079,500000)}),
LineSegmentR({Rational(81549,250000),Rational(-303079,500000)},{Rational(205189,500000),Rational(-545527,1000000)}),
LineSegmentR({Rational(205189,500000),Rational(-545527,1000000)},{Rational(108589,250000),Rational(-463933,1000000)}),
LineSegmentR({Rational(108589,250000),Rational(-463933,1000000)},{Rational(202749,500000),Rational(-36451,100000)}),
LineSegmentR({Rational(202749,500000),Rational(-36451,100000)},{Rational(167999,500000),Rational(-251079,1000000)}),
LineSegmentR({Rational(167999,500000),Rational(-251079,1000000)},{Rational(48119,200000),Rational(-127999,1000000)}),
LineSegmentR({Rational(48119,200000),Rational(-127999,1000000)},{Rational(67381,500000),Rational(0,1)}),
LineSegmentR({Rational(67381,500000),Rational(0,1)},{Rational(3309,100000),Rational(127999,1000000)}),
LineSegmentR({Rational(3309,100000),Rational(127999,1000000)},{Rational(-814,15625),Rational(251079,1000000)}),
LineSegmentR({Rational(-814,15625),Rational(251079,1000000)},{Rational(-55911,500000),Rational(36451,100000)}),
LineSegmentR({Rational(-55911,500000),Rational(36451,100000)},{Rational(-141157,1000000),Rational(463933,1000000)}),
LineSegmentR({Rational(-141157,1000000),Rational(463933,1000000)},{Rational(-3487,25000),Rational(545527,1000000)}),
LineSegmentR({Rational(-3487,25000),Rational(545527,1000000)},{Rational(-110291,1000000),Rational(606157,1000000)}),
LineSegmentR({Rational(-110291,1000000),Rational(606157,1000000)},{Rational(-30303,500000),Rational(643493,1000000)}),
LineSegmentR({Rational(-30303,500000),Rational(643493,1000000)},{Rational(0,1),Rational(6561,10000)}),
LineSegmentR({Rational(30303,500000),Rational(643493,1000000)},{Rational(110291,1000000),Rational(303079,500000)}),
LineSegmentR({Rational(0,1),Rational(59049,100000)},{Rational(5411,125000),Rational(72393,125000)}),
LineSegmentR({Rational(77667,1000000),Rational(272771,500000)},{Rational(95363,1000000),Rational(19639,40000)}),
LineSegmentR({Rational(95363,1000000),Rational(19639,40000)},{Rational(90747,1000000),Rational(20877,50000)}),
LineSegmentR({Rational(90747,1000000),Rational(20877,50000)},{Rational(12229,200000),Rational(328059,1000000)}),
LineSegmentR({Rational(12229,200000),Rational(328059,1000000)},{Rational(7337,1000000),Rational(225971,1000000)}),
LineSegmentR({Rational(7337,1000000),Rational(225971,1000000)},{Rational(-663,10000),Rational(72,625)}),
LineSegmentR({Rational(-663,10000),Rational(72,625)},{Rational(-6081,40000),Rational(1,1000000)}),
LineSegmentR({Rational(-6081,40000),Rational(1,1000000)},{Rational(-239339,1000000),Rational(-57599,500000)}),
LineSegmentR({Rational(-239339,1000000),Rational(-57599,500000)},{Rational(-157963,500000),Rational(-22597,100000)}),
LineSegmentR({Rational(-157963,500000),Rational(-22597,100000)},{Rational(-92217,250000),Rational(-164029,500000)}),
LineSegmentR({Rational(-92217,250000),Rational(-164029,500000)},{Rational(-193043,500000),Rational(-417539,1000000)}),
LineSegmentR({Rational(-193043,500000),Rational(-417539,1000000)},{Rational(-358023,1000000),Rational(-245487,500000)}),
LineSegmentR({Rational(-358023,1000000),Rational(-245487,500000)},{Rational(-279853,1000000),Rational(-272771,500000)}),
LineSegmentR({Rational(-279853,1000000),Rational(-272771,500000)},{Rational(-6199,40000),Rational(-72393,125000)}),
LineSegmentR({Rational(-6199,40000),Rational(-72393,125000)},{Rational(1,1000000),Rational(-59049,100000)}),
LineSegmentR({Rational(1,1000000),Rational(-59049,100000)},{Rational(4843,31250),Rational(-72393,125000)}),
LineSegmentR({Rational(4843,31250),Rational(-72393,125000)},{Rational(139927,500000),Rational(-272771,500000)}),
LineSegmentR({Rational(139927,500000),Rational(-272771,500000)},{Rational(44753,125000),Rational(-19639,40000)}),
LineSegmentR({Rational(44753,125000),Rational(-19639,40000)},{Rational(386087,1000000),Rational(-20877,50000)}),
LineSegmentR({Rational(386087,1000000),Rational(-20877,50000)},{Rational(368869,1000000),Rational(-328059,1000000)}),
LineSegmentR({Rational(368869,1000000),Rational(-328059,1000000)},{Rational(315927,1000000),Rational(-225971,1000000)}),
LineSegmentR({Rational(315927,1000000),Rational(-225971,1000000)},{Rational(11967,50000),Rational(-115199,1000000)}),
LineSegmentR({Rational(11967,50000),Rational(-115199,1000000)},{Rational(76013,500000),Rational(0,1)}),
LineSegmentR({Rational(76013,500000),Rational(0,1)},{Rational(66301,1000000),Rational(115199,1000000)}),
LineSegmentR({Rational(66301,1000000),Rational(115199,1000000)},{Rational(-917,125000),Rational(225971,1000000)}),
LineSegmentR({Rational(-917,125000),Rational(225971,1000000)},{Rational(-12229,200000),Rational(328059,1000000)}),
LineSegmentR({Rational(-12229,200000),Rational(328059,1000000)},{Rational(-45373,500000),Rational(20877,50000)}),
LineSegmentR({Rational(-45373,500000),Rational(20877,50000)},{Rational(-47681,500000),Rational(19639,40000)}),
LineSegmentR({Rational(-47681,500000),Rational(19639,40000)},{Rational(-77667,1000000),Rational(272771,500000)}),
LineSegmentR({Rational(-77667,1000000),Rational(272771,500000)},{Rational(-5411,125000),Rational(72393,125000)}),
LineSegmentR({Rational(-5411,125000),Rational(72393,125000)},{Rational(0,1),Rational(59049,100000)}),
LineSegmentR({Rational(5411,125000),Rational(72393,125000)},{Rational(77667,1000000),Rational(272771,500000)}),
LineSegmentR({Rational(0,1),Rational(531441,1000000)},{Rational(14923,500000),Rational(52123,100000)}),
LineSegmentR({Rational(13113,250000),Rational(122747,250000)},{Rational(6153,100000),Rational(220939,500000)}),
LineSegmentR({Rational(6153,100000),Rational(220939,500000)},{Rational(26297,500000),Rational(187893,500000)}),
LineSegmentR({Rational(26297,500000),Rational(187893,500000)},{Rational(1477,62500),Rational(295253,1000000)}),
LineSegmentR({Rational(1477,62500),Rational(295253,1000000)},{Rational(-12239,500000),Rational(101687,500000)}),
LineSegmentR({Rational(-12239,500000),Rational(101687,500000)},{Rational(-87861,1000000),Rational(324,3125)}),
LineSegmentR({Rational(-87861,1000000),Rational(324,3125)},{Rational(-79927,500000),Rational(0,1)}),
LineSegmentR({Rational(-79927,500000),Rational(0,1)},{Rational(-11577,50000),Rational(-103679,1000000)}),
LineSegmentR({Rational(-11577,50000),Rational(-103679,1000000)},{Rational(-73143,250000),Rational(-203373,1000000)}),
LineSegmentR({Rational(-73143,250000),Rational(-203373,1000000)},{Rational(-66447,200000),Rational(-295253,1000000)}),
LineSegmentR({Rational(-66447,200000),Rational(-295253,1000000)},{Rational(-42593,125000),Rational(-75157,200000)}),
LineSegmentR({Rational(-42593,125000),Rational(-75157,200000)},{Rational(-310779,1000000),Rational(-441877,1000000)}),
LineSegmentR({Rational(-310779,1000000),Rational(-441877,1000000)},{Rational(-239479,1000000),Rational(-490987,1000000)}),
LineSegmentR({Rational(-239479,1000000),Rational(-490987,1000000)},{Rational(-2623,20000),Rational(-52123,100000)}),
LineSegmentR({Rational(-2623,20000),Rational(-52123,100000)},{Rational(1,1000000),Rational(-531441,1000000)}),
LineSegmentR({Rational(1,1000000),Rational(-531441,1000000)},{Rational(131151,1000000),Rational(-52123,100000)}),
LineSegmentR({Rational(131151,1000000),Rational(-52123,100000)},{Rational(5987,25000),Rational(-122747,250000)}),
LineSegmentR({Rational(5987,25000),Rational(-122747,250000)},{Rational(15539,50000),Rational(-441877,1000000)}),
LineSegmentR({Rational(15539,50000),Rational(-441877,1000000)},{Rational(68149,200000),Rational(-187893,500000)}),
LineSegmentR({Rational(68149,200000),Rational(-187893,500000)},{Rational(83059,250000),Rational(-295253,1000000)}),
LineSegmentR({Rational(83059,250000),Rational(-295253,1000000)},{Rational(292573,1000000),Rational(-101687,500000)}),
LineSegmentR({Rational(292573,1000000),Rational(-101687,500000)},{Rational(231541,1000000),Rational(-103679,1000000)}),
LineSegmentR({Rational(231541,1000000),Rational(-103679,1000000)},{Rational(31971,200000),Rational(0,1)}),
LineSegmentR({Rational(31971,200000),Rational(0,1)},{Rational(87861,1000000),Rational(103679,1000000)}),
LineSegmentR({Rational(87861,1000000),Rational(103679,1000000)},{Rational(12239,500000),Rational(101687,500000)}),
LineSegmentR({Rational(12239,500000),Rational(101687,500000)},{Rational(-1477,62500),Rational(295253,1000000)}),
LineSegmentR({Rational(-1477,62500),Rational(295253,1000000)},{Rational(-52593,1000000),Rational(187893,500000)}),
LineSegmentR({Rational(-52593,1000000),Rational(187893,500000)},{Rational(-61529,1000000),Rational(441877,1000000)}),
LineSegmentR({Rational(-61529,1000000),Rational(441877,1000000)},{Rational(-13113,250000),Rational(122747,250000)}),
LineSegmentR({Rational(-13113,250000),Rational(122747,250000)},{Rational(-5969,200000),Rational(52123,100000)}),
LineSegmentR({Rational(-5969,200000),Rational(52123,100000)},{Rational(0,1),Rational(531441,1000000)}),
LineSegmentR({Rational(14923,500000),Rational(52123,100000)},{Rational(13113,250000),Rational(122747,250000)}),
LineSegmentR({Rational(0,1),Rational(478297,1000000)},{Rational(4871,250000),Rational(469107,1000000)}),
LineSegmentR({Rational(8277,250000),Rational(441889,1000000)},{Rational(35811,1000000),Rational(39769,100000)}),
LineSegmentR({Rational(35811,1000000),Rational(39769,100000)},{Rational(24041,1000000),Rational(10569,31250)}),
LineSegmentR({Rational(24041,1000000),Rational(10569,31250)},{Rational(-737,200000),Rational(4152,15625)}),
LineSegmentR({Rational(-737,200000),Rational(4152,15625)},{Rational(-46439,1000000),Rational(183037,1000000)}),
LineSegmentR({Rational(-46439,1000000),Rational(183037,1000000)},{Rational(-100801,1000000),Rational(1458,15625)}),
LineSegmentR({Rational(-100801,1000000),Rational(1458,15625)},{Rational(-80527,500000),Rational(0,1)}),
LineSegmentR({Rational(-80527,500000),Rational(0,1)},{Rational(-219649,1000000),Rational(-93311,1000000)}),
LineSegmentR({Rational(-219649,1000000),Rational(-93311,1000000)},{Rational(-267933,1000000),Rational(-45759,250000)}),
LineSegmentR({Rational(-267933,1000000),Rational(-45759,250000)},{Rational(-297083,1000000),Rational(-265727,1000000)}),
LineSegmentR({Rational(-297083,1000000),Rational(-265727,1000000)},{Rational(-149629,500000),Rational(-338207,1000000)}),
LineSegmentR({Rational(-149629,500000),Rational(-338207,1000000)},{Rational(-268969,1000000),Rational(-397689,1000000)}),
LineSegmentR({Rational(-268969,1000000),Rational(-397689,1000000)},{Rational(-204759,1000000),Rational(-441889,1000000)}),
LineSegmentR({Rational(-204759,1000000),Rational(-441889,1000000)},{Rational(-111151,1000000),Rational(-469107,1000000)}),
LineSegmentR({Rational(-111151,1000000),Rational(-469107,1000000)},{Rational(1,1000000),Rational(-478297,1000000)}),
LineSegmentR({Rational(1,1000000),Rational(-478297,1000000)},{Rational(6947,62500),Rational(-469107,1000000)}),
LineSegmentR({Rational(6947,62500),Rational(-469107,1000000)},{Rational(5119,25000),Rational(-441889,1000000)}),
LineSegmentR({Rational(5119,25000),Rational(-441889,1000000)},{Rational(268971,1000000),Rational(-397689,1000000)}),
LineSegmentR({Rational(268971,1000000),Rational(-397689,1000000)},{Rational(299259,1000000),Rational(-338207,1000000)}),
LineSegmentR({Rational(299259,1000000),Rational(-338207,1000000)},{Rational(74271,250000),Rational(-4152,15625)}),
LineSegmentR({Rational(74271,250000),Rational(-4152,15625)},{Rational(133967,500000),Rational(-45759,250000)}),
LineSegmentR({Rational(133967,500000),Rational(-45759,250000)},{Rational(4393,20000),Rational(-93311,1000000)}),
LineSegmentR({Rational(4393,20000),Rational(-93311,1000000)},{Rational(32211,200000),Rational(0,1)}),
LineSegmentR({Rational(32211,200000),Rational(0,1)},{Rational(50401,500000),Rational(93311,1000000)}),
LineSegmentR({Rational(50401,500000),Rational(93311,1000000)},{Rational(1161,25000),Rational(45759,250000)}),
LineSegmentR({Rational(1161,25000),Rational(45759,250000)},{Rational(737,200000),Rational(4152,15625)}),
LineSegmentR({Rational(737,200000),Rational(4152,15625)},{Rational(-24041,1000000),Rational(338207,1000000)}),
LineSegmentR({Rational(-24041,1000000),Rational(338207,1000000)},{Rational(-35811,1000000),Rational(397689,1000000)}),
LineSegmentR({Rational(-35811,1000000),Rational(397689,1000000)},{Rational(-8277,250000),Rational(441889,1000000)}),
LineSegmentR({Rational(-8277,250000),Rational(441889,1000000)},{Rational(-19483,1000000),Rational(469107,1000000)}),
LineSegmentR({Rational(-19483,1000000),Rational(469107,1000000)},{Rational(0,1),Rational(478297,1000000)}),
LineSegmentR({Rational(4871,250000),Rational(469107,1000000)},{Rational(8277,250000),Rational(441889,1000000)}),
LineSegmentR({Rational(0,1),Rational(430467,1000000)},{Rational(11563,1000000),Rational(105549,250000)}),
LineSegmentR({Rational(9203,500000),Rational(3977,10000)},{Rational(659,40000),Rational(357921,1000000)}),
LineSegmentR({Rational(659,40000),Rational(357921,1000000)},{Rational(2979,1000000),Rational(304387,1000000)}),
LineSegmentR({Rational(2979,1000000),Rational(304387,1000000)},{Rational(-11573,500000),Rational(47831,200000)}),
LineSegmentR({Rational(-11573,500000),Rational(47831,200000)},{Rational(-60957,1000000),Rational(164733,1000000)}),
LineSegmentR({Rational(-60957,1000000),Rational(164733,1000000)},{Rational(-13431,125000),Rational(4199,50000)}),
LineSegmentR({Rational(-13431,125000),Rational(4199,50000)},{Rational(-78863,500000),Rational(0,1)}),
LineSegmentR({Rational(-78863,500000),Rational(0,1)},{Rational(-205427,1000000),Rational(-4199,50000)}),
LineSegmentR({Rational(-205427,1000000),Rational(-4199,50000)},{Rational(-243347,1000000),Rational(-41183,250000)}),
LineSegmentR({Rational(-243347,1000000),Rational(-41183,250000)},{Rational(-16517,62500),Rational(-47831,200000)}),
LineSegmentR({Rational(-16517,62500),Rational(-47831,200000)},{Rational(-261983,1000000),Rational(-152193,500000)}),
LineSegmentR({Rational(-261983,1000000),Rational(-152193,500000)},{Rational(-116219,500000),Rational(-2237,6250)}),
LineSegmentR({Rational(-116219,500000),Rational(-2237,6250)},{Rational(-87561,500000),Rational(-3977,10000)}),
LineSegmentR({Rational(-87561,500000),Rational(-3977,10000)},{Rational(-18877,200000),Rational(-105549,250000)}),
LineSegmentR({Rational(-18877,200000),Rational(-105549,250000)},{Rational(1,1000000),Rational(-430467,1000000)}),
LineSegmentR({Rational(1,1000000),Rational(-430467,1000000)},{Rational(47193,500000),Rational(-105549,250000)}),
LineSegmentR({Rational(47193,500000),Rational(-105549,250000)},{Rational(175123,1000000),Rational(-3977,10000)}),
LineSegmentR({Rational(175123,1000000),Rational(-3977,10000)},{Rational(232439,1000000),Rational(-357921,1000000)}),
LineSegmentR({Rational(232439,1000000),Rational(-357921,1000000)},{Rational(8187,31250),Rational(-152193,500000)}),
LineSegmentR({Rational(8187,31250),Rational(-152193,500000)},{Rational(264273,1000000),Rational(-47831,200000)}),
LineSegmentR({Rational(264273,1000000),Rational(-47831,200000)},{Rational(60837,250000),Rational(-164733,1000000)}),
LineSegmentR({Rational(60837,250000),Rational(-164733,1000000)},{Rational(51357,250000),Rational(-4199,50000)}),
LineSegmentR({Rational(51357,250000),Rational(-4199,50000)},{Rational(157727,1000000),Rational(0,1)}),
LineSegmentR({Rational(157727,1000000),Rational(0,1)},{Rational(107449,1000000),Rational(4199,50000)}),
LineSegmentR({Rational(107449,1000000),Rational(4199,50000)},{Rational(30479,500000),Rational(164733,1000000)}),
LineSegmentR({Rational(30479,500000),Rational(164733,1000000)},{Rational(23147,1000000),Rational(47831,200000)}),
LineSegmentR({Rational(23147,1000000),Rational(47831,200000)},{Rational(-1489,500000),Rational(152193,500000)}),
LineSegmentR({Rational(-1489,500000),Rational(152193,500000)},{Rational(-8237,500000),Rational(2237,6250)}),
LineSegmentR({Rational(-8237,500000),Rational(2237,6250)},{Rational(-9203,500000),Rational(3977,10000)}),
LineSegmentR({Rational(-9203,500000),Rational(3977,10000)},{Rational(-11563,1000000),Rational(105549,250000)}),
LineSegmentR({Rational(-11563,1000000),Rational(105549,250000)},{Rational(0,1),Rational(430467,1000000)}),
LineSegmentR({Rational(11563,1000000),Rational(105549,250000)},{Rational(9203,500000),Rational(3977,10000)}),
LineSegmentR({Rational(0,1),Rational(387421,1000000)},{Rational(5573,1000000),Rational(379977,1000000)}),
LineSegmentR({Rational(7361,1000000),Rational(35793,100000)},{Rational(107,50000),Rational(322129,1000000)}),
LineSegmentR({Rational(107,50000),Rational(322129,1000000)},{Rational(-2453,200000),Rational(68487,250000)}),
LineSegmentR({Rational(-2453,200000),Rational(68487,250000)},{Rational(-36589,1000000),Rational(5381,25000)}),
LineSegmentR({Rational(-36589,1000000),Rational(5381,25000)},{Rational(-34951,500000),Rational(7413,50000)}),
LineSegmentR({Rational(-34951,500000),Rational(7413,50000)},{Rational(-109571,1000000),Rational(37791,500000)}),
LineSegmentR({Rational(-109571,1000000),Rational(37791,500000)},{Rational(-151423,1000000),Rational(0,1)}),
LineSegmentR({Rational(-151423,1000000),Rational(0,1)},{Rational(-190111,1000000),Rational(-37791,500000)}),
LineSegmentR({Rational(-190111,1000000),Rational(-37791,500000)},{Rational(-219669,1000000),Rational(-148259,1000000)}),
LineSegmentR({Rational(-219669,1000000),Rational(-148259,1000000)},{Rational(-234233,1000000),Rational(-215239,1000000)}),
LineSegmentR({Rational(-234233,1000000),Rational(-215239,1000000)},{Rational(-14307,62500),Rational(-68487,250000)}),
LineSegmentR({Rational(-14307,62500),Rational(-68487,250000)},{Rational(-200781,1000000),Rational(-20133,62500)}),
LineSegmentR({Rational(-200781,1000000),Rational(-20133,62500)},{Rational(-5997,40000),Rational(-35793,100000)}),
LineSegmentR({Rational(-5997,40000),Rational(-35793,100000)},{Rational(-80327,1000000),Rational(-47497,125000)}),
LineSegmentR({Rational(-80327,1000000),Rational(-47497,125000)},{Rational(1,1000000),Rational(-387421,1000000)}),
LineSegmentR({Rational(1,1000000),Rational(-387421,1000000)},{Rational(10041,125000),Rational(-379977,1000000)}),
LineSegmentR({Rational(10041,125000),Rational(-379977,1000000)},{Rational(74963,500000),Rational(-35793,100000)}),
LineSegmentR({Rational(74963,500000),Rational(-35793,100000)},{Rational(100391,500000),Rational(-322129,1000000)}),
LineSegmentR({Rational(100391,500000),Rational(-322129,1000000)},{Rational(228913,1000000),Rational(-68487,250000)}),
LineSegmentR({Rational(228913,1000000),Rational(-68487,250000)},{Rational(117117,500000),Rational(-215239,1000000)}),
LineSegmentR({Rational(117117,500000),Rational(-215239,1000000)},{Rational(21967,100000),Rational(-148259,1000000)}),
LineSegmentR({Rational(21967,100000),Rational(-148259,1000000)},{Rational(5941,31250),Rational(-37791,500000)}),
LineSegmentR({Rational(5941,31250),Rational(-37791,500000)},{Rational(2366,15625),Rational(0,1)}),
LineSegmentR({Rational(2366,15625),Rational(0,1)},{Rational(27393,250000),Rational(37791,500000)}),
LineSegmentR({Rational(27393,250000),Rational(37791,500000)},{Rational(69903,1000000),Rational(148259,1000000)}),
LineSegmentR({Rational(69903,1000000),Rational(148259,1000000)},{Rational(3659,100000),Rational(215239,1000000)}),
LineSegmentR({Rational(3659,100000),Rational(215239,1000000)},{Rational(6133,500000),Rational(68487,250000)}),
LineSegmentR({Rational(6133,500000),Rational(68487,250000)},{Rational(-2139,1000000),Rational(322129,1000000)}),
LineSegmentR({Rational(-2139,1000000),Rational(322129,1000000)},{Rational(-7361,1000000),Rational(35793,100000)}),
LineSegmentR({Rational(-7361,1000000),Rational(35793,100000)},{Rational(-1393,250000),Rational(47497,125000)}),
LineSegmentR({Rational(-1393,250000),Rational(47497,125000)},{Rational(0,1),Rational(387421,1000000)}),
LineSegmentR({Rational(5573,1000000),Rational(379977,1000000)},{Rational(7361,1000000),Rational(35793,100000)}),
LineSegmentR({Rational(0,1),Rational(348679,1000000)},{Rational(551,500000),Rational(341979,1000000)}),
LineSegmentR({Rational(-203,250000),Rational(322137,1000000)},{Rational(-2073,250000),Rational(72479,250000)}),
LineSegmentR({Rational(-2073,250000),Rational(72479,250000)},{Rational(-23013,1000000),Rational(246553,1000000)}),
LineSegmentR({Rational(-23013,1000000),Rational(246553,1000000)},{Rational(-9091,200000),Rational(48429,250000)}),
LineSegmentR({Rational(-9091,200000),Rational(48429,250000)},{Rational(-74721,1000000),Rational(66717,500000)}),
LineSegmentR({Rational(-74721,1000000),Rational(66717,500000)},{Rational(-3391,31250),Rational(8503,125000)}),
LineSegmentR({Rational(-3391,31250),Rational(8503,125000)},{Rational(-143281,1000000),Rational(0,1)}),
LineSegmentR({Rational(-143281,1000000),Rational(0,1)},{Rational(-21819,125000),Rational(-8503,125000)}),
LineSegmentR({Rational(-21819,125000),Rational(-8503,125000)},{Rational(-98703,500000),Rational(-133433,1000000)}),
LineSegmentR({Rational(-98703,500000),Rational(-133433,1000000)},{Rational(-207103,1000000),Rational(-38743,200000)}),
LineSegmentR({Rational(-207103,1000000),Rational(-38743,200000)},{Rational(-99913,500000),Rational(-246553,1000000)}),
LineSegmentR({Rational(-99913,500000),Rational(-246553,1000000)},{Rational(-173491,1000000),Rational(-72479,250000)}),
LineSegmentR({Rational(-173491,1000000),Rational(-72479,250000)},{Rational(-25709,200000),Rational(-322137,1000000)}),
LineSegmentR({Rational(-25709,200000),Rational(-322137,1000000)},{Rational(-34263,500000),Rational(-341979,1000000)}),
LineSegmentR({Rational(-34263,500000),Rational(-341979,1000000)},{Rational(1,1000000),Rational(-348679,1000000)}),
LineSegmentR({Rational(1,1000000),Rational(-348679,1000000)},{Rational(68527,1000000),Rational(-341979,1000000)}),
LineSegmentR({Rational(68527,1000000),Rational(-341979,1000000)},{Rational(64273,500000),Rational(-322137,1000000)}),
LineSegmentR({Rational(64273,500000),Rational(-322137,1000000)},{Rational(43373,250000),Rational(-72479,250000)}),
LineSegmentR({Rational(43373,250000),Rational(-72479,250000)},{Rational(199827,1000000),Rational(-246553,1000000)}),
LineSegmentR({Rational(199827,1000000),Rational(-246553,1000000)},{Rational(3236,15625),Rational(-38743,200000)}),
LineSegmentR({Rational(3236,15625),Rational(-38743,200000)},{Rational(98703,500000),Rational(-133433,1000000)}),
LineSegmentR({Rational(98703,500000),Rational(-133433,1000000)},{Rational(174553,1000000),Rational(-8503,125000)}),
LineSegmentR({Rational(174553,1000000),Rational(-8503,125000)},{Rational(71641,500000),Rational(0,1)}),
LineSegmentR({Rational(71641,500000),Rational(0,1)},{Rational(108513,1000000),Rational(8503,125000)}),
LineSegmentR({Rational(108513,1000000),Rational(8503,125000)},{Rational(37361,500000),Rational(133433,1000000)}),
LineSegmentR({Rational(37361,500000),Rational(133433,1000000)},{Rational(2841,62500),Rational(38743,200000)}),
LineSegmentR({Rational(2841,62500),Rational(38743,200000)},{Rational(11507,500000),Rational(246553,1000000)}),
LineSegmentR({Rational(11507,500000),Rational(246553,1000000)},{Rational(8293,1000000),Rational(72479,250000)}),
LineSegmentR({Rational(8293,1000000),Rational(72479,250000)},{Rational(203,250000),Rational(322137,1000000)}),
LineSegmentR({Rational(203,250000),Rational(322137,1000000)},{Rational(-1101,1000000),Rational(341979,1000000)}),
LineSegmentR({Rational(-1101,1000000),Rational(341979,1000000)},{Rational(0,1),Rational(348679,1000000)}),
LineSegmentR({Rational(551,500000),Rational(341979,1000000)},{Rational(-203,250000),Rational(322137,1000000)}),
LineSegmentR({Rational(0,1),Rational(313811,1000000)},{Rational(-34,15625),Rational(307781,1000000)}),
LineSegmentR({Rational(-337,50000),Rational(289923,1000000)},{Rational(-15693,1000000),Rational(65231,250000)}),
LineSegmentR({Rational(-15693,1000000),Rational(65231,250000)},{Rational(-30307,1000000),Rational(110949,500000)}),
LineSegmentR({Rational(-30307,1000000),Rational(110949,500000)},{Rational(-12717,250000),Rational(21793,125000)}),
LineSegmentR({Rational(-12717,250000),Rational(21793,125000)},{Rational(-76523,1000000),Rational(12009,100000)}),
LineSegmentR({Rational(-76523,1000000),Rational(12009,100000)},{Rational(-52637,500000),Rational(30611,500000)}),
LineSegmentR({Rational(-52637,500000),Rational(30611,500000)},{Rational(-26823,200000),Rational(0,1)}),
LineSegmentR({Rational(-26823,200000),Rational(0,1)},{Rational(-159311,1000000),Rational(-61221,1000000)}),
LineSegmentR({Rational(-159311,1000000),Rational(-61221,1000000)},{Rational(-88411,500000),Rational(-12009,100000)}),
LineSegmentR({Rational(-88411,500000),Rational(-12009,100000)},{Rational(-182837,1000000),Rational(-21793,125000)}),
LineSegmentR({Rational(-182837,1000000),Rational(-21793,125000)},{Rational(-34879,200000),Rational(-110949,500000)}),
LineSegmentR({Rational(-34879,200000),Rational(-110949,500000)},{Rational(-150039,1000000),Rational(-65231,250000)}),
LineSegmentR({Rational(-150039,1000000),Rational(-65231,250000)},{Rational(-27603,250000),Rational(-289923,1000000)}),
LineSegmentR({Rational(-27603,250000),Rational(-289923,1000000)},{Rational(-29303,500000),Rational(-307781,1000000)}),
LineSegmentR({Rational(-29303,500000),Rational(-307781,1000000)},{Rational(1,1000000),Rational(-313811,1000000)}),
LineSegmentR({Rational(1,1000000),Rational(-313811,1000000)},{Rational(58607,1000000),Rational(-307781,1000000)}),
LineSegmentR({Rational(58607,1000000),Rational(-307781,1000000)},{Rational(110413,1000000),Rational(-289923,1000000)}),
LineSegmentR({Rational(110413,1000000),Rational(-289923,1000000)},{Rational(3751,25000),Rational(-65231,250000)}),
LineSegmentR({Rational(3751,25000),Rational(-65231,250000)},{Rational(43599,250000),Rational(-110949,500000)}),
LineSegmentR({Rational(43599,250000),Rational(-110949,500000)},{Rational(91419,500000),Rational(-21793,125000)}),
LineSegmentR({Rational(91419,500000),Rational(-21793,125000)},{Rational(176823,1000000),Rational(-12009,100000)}),
LineSegmentR({Rational(176823,1000000),Rational(-12009,100000)},{Rational(9957,62500),Rational(-61221,1000000)}),
LineSegmentR({Rational(9957,62500),Rational(-61221,1000000)},{Rational(33529,250000),Rational(0,1)}),
LineSegmentR({Rational(33529,250000),Rational(0,1)},{Rational(4211,40000),Rational(61221,1000000)}),
LineSegmentR({Rational(4211,40000),Rational(61221,1000000)},{Rational(19131,250000),Rational(12009,100000)}),
LineSegmentR({Rational(19131,250000),Rational(12009,100000)},{Rational(50869,1000000),Rational(21793,125000)}),
LineSegmentR({Rational(50869,1000000),Rational(21793,125000)},{Rational(7577,250000),Rational(110949,500000)}),
LineSegmentR({Rational(7577,250000),Rational(110949,500000)},{Rational(7847,500000),Rational(65231,250000)}),
LineSegmentR({Rational(7847,500000),Rational(65231,250000)},{Rational(6741,1000000),Rational(289923,1000000)}),
LineSegmentR({Rational(6741,1000000),Rational(289923,1000000)},{Rational(2177,1000000),Rational(307781,1000000)}),
LineSegmentR({Rational(2177,1000000),Rational(307781,1000000)},{Rational(0,1),Rational(313811,1000000)}),
LineSegmentR({Rational(-34,15625),Rational(307781,1000000)},{Rational(-337,50000),Rational(289923,1000000)}),
LineSegmentR({Rational(0,1),Rational(28243,100000)},{Rational(-4523,1000000),Rational(277003,1000000)}),
LineSegmentR({Rational(-10923,1000000),Rational(260931,1000000)},{Rational(-20753,1000000),Rational(14677,62500)}),
LineSegmentR({Rational(-20753,1000000),Rational(14677,62500)},{Rational(-34967,1000000),Rational(49927,250000)}),
LineSegmentR({Rational(-34967,1000000),Rational(49927,250000)},{Rational(-26851,500000),Rational(15691,100000)}),
LineSegmentR({Rational(-26851,500000),Rational(15691,100000)},{Rational(-38079,500000),Rational(108081,1000000)}),
LineSegmentR({Rational(-38079,500000),Rational(108081,1000000)},{Rational(-50303,500000),Rational(551,10000)}),
LineSegmentR({Rational(-50303,500000),Rational(551,10000)},{Rational(-62251,500000),Rational(0,1)}),
LineSegmentR({Rational(-62251,500000),Rational(0,1)},{Rational(-72371,500000),Rational(-55099,1000000)}),
LineSegmentR({Rational(-72371,500000),Rational(-55099,1000000)},{Rational(-7901,50000),Rational(-108081,1000000)}),
LineSegmentR({Rational(-7901,50000),Rational(-108081,1000000)},{Rational(-161283,1000000),Rational(-156909,1000000)}),
LineSegmentR({Rational(-161283,1000000),Rational(-156909,1000000)},{Rational(-19031,125000),Rational(-49927,250000)}),
LineSegmentR({Rational(-19031,125000),Rational(-49927,250000)},{Rational(-129919,1000000),Rational(-14677,62500)}),
LineSegmentR({Rational(-129919,1000000),Rational(-14677,62500)},{Rational(-9503,100000),Rational(-260931,1000000)}),
LineSegmentR({Rational(-9503,100000),Rational(-260931,1000000)},{Rational(-50251,1000000),Rational(-277003,1000000)}),
LineSegmentR({Rational(-50251,1000000),Rational(-277003,1000000)},{Rational(1,1000000),Rational(-28243,100000)}),
LineSegmentR({Rational(1,1000000),Rational(-28243,100000)},{Rational(12563,250000),Rational(-277003,1000000)}),
LineSegmentR({Rational(12563,250000),Rational(-277003,1000000)},{Rational(95031,1000000),Rational(-260931,1000000)}),
LineSegmentR({Rational(95031,1000000),Rational(-260931,1000000)},{Rational(406,3125),Rational(-14677,62500)}),
LineSegmentR({Rational(406,3125),Rational(-14677,62500)},{Rational(152249,1000000),Rational(-49927,250000)}),
LineSegmentR({Rational(152249,1000000),Rational(-49927,250000)},{Rational(40321,250000),Rational(-156909,1000000)}),
LineSegmentR({Rational(40321,250000),Rational(-156909,1000000)},{Rational(158021,1000000),Rational(-108081,1000000)}),
LineSegmentR({Rational(158021,1000000),Rational(-108081,1000000)},{Rational(144743,1000000),Rational(-55099,1000000)}),
LineSegmentR({Rational(144743,1000000),Rational(-55099,1000000)},{Rational(124503,1000000),Rational(0,1)}),
LineSegmentR({Rational(124503,1000000),Rational(0,1)},{Rational(100607,1000000),Rational(55099,1000000)}),
LineSegmentR({Rational(100607,1000000),Rational(55099,1000000)},{Rational(76159,1000000),Rational(108081,1000000)}),
LineSegmentR({Rational(76159,1000000),Rational(108081,1000000)},{Rational(53703,1000000),Rational(156909,1000000)}),
LineSegmentR({Rational(53703,1000000),Rational(156909,1000000)},{Rational(4371,125000),Rational(49927,250000)}),
LineSegmentR({Rational(4371,125000),Rational(49927,250000)},{Rational(10377,500000),Rational(14677,62500)}),
LineSegmentR({Rational(10377,500000),Rational(14677,62500)},{Rational(2731,250000),Rational(260931,1000000)}),
LineSegmentR({Rational(2731,250000),Rational(260931,1000000)},{Rational(1131,250000),Rational(277003,1000000)}),
LineSegmentR({Rational(1131,250000),Rational(277003,1000000)},{Rational(0,1),Rational(28243,100000)}),
LineSegmentR({Rational(-4523,1000000),Rational(277003,1000000)},{Rational(-10923,1000000),Rational(260931,1000000)}),
};
std::vector<PointR> intersections = getIntersectionsBrute(lines);
auto events = bentleyOttmann(lines);
std::vector<PointR> results;
for (const auto& event : events)
	results.push_back(event.first);
EXPECT_THAT(results, UnorderedElementsAreArray(intersections));
}

TEST(bentleyOttmann, TestIsectCrosshatch01) {
std::vector<LineSegmentR> lines = {
LineSegmentR({Rational(-1,1),Rational(9,10)},{Rational(9,10),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(3,5)},{Rational(3,5),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(1,2)},{Rational(1,2),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(2,5)},{Rational(2,5),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-9,10)},{Rational(-9,10),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-3,5)},{Rational(-3,5),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-1,2)},{Rational(-1,2),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-2,5)},{Rational(-2,5),Rational(-1,1)}),
LineSegmentR({Rational(-1,10),Rational(-1,1)},{Rational(-1,1),Rational(-1,10)}),
LineSegmentR({Rational(-1,1),Rational(0,1)},{Rational(0,1),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(1,10)},{Rational(1,10),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(1,1)},{Rational(1,1),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-9,10)},{Rational(-9,10),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(-3,5)},{Rational(-3,5),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(-1,2)},{Rational(-1,2),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(-2,5)},{Rational(-2,5),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(9,10)},{Rational(9,10),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(3,5)},{Rational(3,5),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(1,2)},{Rational(1,2),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(2,5)},{Rational(2,5),Rational(1,1)}),
LineSegmentR({Rational(1,10),Rational(1,1)},{Rational(1,1),Rational(1,10)}),
LineSegmentR({Rational(1,1),Rational(0,1)},{Rational(0,1),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(-1,10)},{Rational(-1,10),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(4,5)},{Rational(4,5),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(7,10)},{Rational(7,10),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(3,10)},{Rational(3,10),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(1,5)},{Rational(1,5),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-4,5)},{Rational(-4,5),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-7,10)},{Rational(-7,10),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-3,10)},{Rational(-3,10),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-1,5)},{Rational(-1,5),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-4,5)},{Rational(-4,5),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(-7,10)},{Rational(-7,10),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(-3,10)},{Rational(-3,10),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(-1,5)},{Rational(-1,5),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(7,10)},{Rational(7,10),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(1,5)},{Rational(1,5),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(4,5)},{Rational(4,5),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(3,10)},{Rational(3,10),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(9,10)},{Rational(-9,10),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(4,5)},{Rational(-4,5),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(7,10)},{Rational(-7,10),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(3,5)},{Rational(-3,5),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(1,2)},{Rational(-1,2),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(2,5)},{Rational(-2,5),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(3,10)},{Rational(-3,10),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(1,5)},{Rational(-1,5),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-9,10)},{Rational(9,10),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-4,5)},{Rational(4,5),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-7,10)},{Rational(7,10),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-3,5)},{Rational(3,5),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-1,2)},{Rational(1,2),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-2,5)},{Rational(2,5),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-3,10)},{Rational(3,10),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(-1,5)},{Rational(1,5),Rational(-1,1)}),
LineSegmentR({Rational(1,10),Rational(-1,1)},{Rational(1,1),Rational(-1,10)}),
LineSegmentR({Rational(1,1),Rational(0,1)},{Rational(0,1),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(1,10)},{Rational(-1,10),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-4,5)},{Rational(4,5),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(-7,10)},{Rational(7,10),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(-3,10)},{Rational(3,10),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(-1,5)},{Rational(1,5),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(7,10)},{Rational(-7,10),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(1,5)},{Rational(-1,5),Rational(1,1)}),
LineSegmentR({Rational(1,1),Rational(1,1)},{Rational(-1,1),Rational(-1,1)}),
LineSegmentR({Rational(-1,1),Rational(-9,10)},{Rational(9,10),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(-3,5)},{Rational(3,5),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(-1,2)},{Rational(1,2),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(-2,5)},{Rational(2,5),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(9,10)},{Rational(-9,10),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(4,5)},{Rational(-4,5),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(3,5)},{Rational(-3,5),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(1,2)},{Rational(-1,2),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(2,5)},{Rational(-2,5),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(3,10)},{Rational(-3,10),Rational(1,1)}),
LineSegmentR({Rational(-1,10),Rational(1,1)},{Rational(-1,1),Rational(1,10)}),
LineSegmentR({Rational(-1,1),Rational(0,1)},{Rational(0,1),Rational(1,1)}),
LineSegmentR({Rational(-1,1),Rational(-1,10)},{Rational(1,10),Rational(1,1)}),
};
std::vector<PointR> intersections = getIntersectionsBrute(lines);
auto events = bentleyOttmann(lines);
std::vector<PointR> results;
for (const auto& event : events)
	results.push_back(event.first);
EXPECT_THAT(results, UnorderedElementsAreArray(intersections));
}

TEST(bentleyOttmann, TestIsectCrosshatch02) {
std::vector<LineSegmentR> lines = {
LineSegmentR({Rational(0,1),Rational(1,1)},{Rational(0,1),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(3,10)},{Rational(-1,1),Rational(3,10)}),
LineSegmentR({Rational(1,1),Rational(4,5)},{Rational(-1,1),Rational(4,5)}),
LineSegmentR({Rational(-1,10),Rational(1,1)},{Rational(-1,10),Rational(-1,1)}),
LineSegmentR({Rational(-2,5),Rational(1,1)},{Rational(-2,5),Rational(-1,1)}),
LineSegmentR({Rational(-1,2),Rational(1,1)},{Rational(-1,2),Rational(-1,1)}),
LineSegmentR({Rational(-3,5),Rational(1,1)},{Rational(-3,5),Rational(-1,1)}),
LineSegmentR({Rational(-9,10),Rational(1,1)},{Rational(-9,10),Rational(-1,1)}),
LineSegmentR({Rational(9,10),Rational(1,1)},{Rational(9,10),Rational(-1,1)}),
LineSegmentR({Rational(3,5),Rational(1,1)},{Rational(3,5),Rational(-1,1)}),
LineSegmentR({Rational(1,2),Rational(1,1)},{Rational(1,2),Rational(-1,1)}),
LineSegmentR({Rational(2,5),Rational(1,1)},{Rational(2,5),Rational(-1,1)}),
LineSegmentR({Rational(1,10),Rational(1,1)},{Rational(1,10),Rational(-1,1)}),
LineSegmentR({Rational(1,1),Rational(0,1)},{Rational(-1,1),Rational(0,1)}),
LineSegmentR({Rational(1,1),Rational(1,10)},{Rational(-1,1),Rational(1,10)}),
LineSegmentR({Rational(1,1),Rational(1,5)},{Rational(-1,1),Rational(1,5)}),
LineSegmentR({Rational(1,1),Rational(2,5)},{Rational(-1,1),Rational(2,5)}),
LineSegmentR({Rational(1,1),Rational(1,2)},{Rational(-1,1),Rational(1,2)}),
LineSegmentR({Rational(1,1),Rational(3,5)},{Rational(-1,1),Rational(3,5)}),
LineSegmentR({Rational(1,1),Rational(7,10)},{Rational(-1,1),Rational(7,10)}),
LineSegmentR({Rational(1,1),Rational(9,10)},{Rational(-1,1),Rational(9,10)}),
LineSegmentR({Rational(1,1),Rational(-9,10)},{Rational(-1,1),Rational(-9,10)}),
LineSegmentR({Rational(1,1),Rational(-4,5)},{Rational(-1,1),Rational(-4,5)}),
LineSegmentR({Rational(1,1),Rational(-7,10)},{Rational(-1,1),Rational(-7,10)}),
LineSegmentR({Rational(1,1),Rational(-3,5)},{Rational(-1,1),Rational(-3,5)}),
LineSegmentR({Rational(1,1),Rational(-1,2)},{Rational(-1,1),Rational(-1,2)}),
LineSegmentR({Rational(1,1),Rational(-2,5)},{Rational(-1,1),Rational(-2,5)}),
LineSegmentR({Rational(1,1),Rational(-3,10)},{Rational(-1,1),Rational(-3,10)}),
LineSegmentR({Rational(1,1),Rational(-1,5)},{Rational(-1,1),Rational(-1,5)}),
LineSegmentR({Rational(1,1),Rational(-1,10)},{Rational(-1,1),Rational(-1,10)}),
LineSegmentR({Rational(-1,5),Rational(1,1)},{Rational(-1,5),Rational(-1,1)}),
LineSegmentR({Rational(-3,10),Rational(1,1)},{Rational(-3,10),Rational(-1,1)}),
LineSegmentR({Rational(-7,10),Rational(1,1)},{Rational(-7,10),Rational(-1,1)}),
LineSegmentR({Rational(-4,5),Rational(1,1)},{Rational(-4,5),Rational(-1,1)}),
LineSegmentR({Rational(4,5),Rational(1,1)},{Rational(4,5),Rational(-1,1)}),
LineSegmentR({Rational(7,10),Rational(1,1)},{Rational(7,10),Rational(-1,1)}),
LineSegmentR({Rational(3,10),Rational(1,1)},{Rational(3,10),Rational(-1,1)}),
LineSegmentR({Rational(1,5),Rational(1,1)},{Rational(1,5),Rational(-1,1)}),
};
std::vector<PointR> intersections = getIntersectionsBrute(lines);
auto events = bentleyOttmann(lines);
std::vector<PointR> results;
for (const auto& event : events)
	results.push_back(event.first);
EXPECT_THAT(results, UnorderedElementsAreArray(intersections));
}

TEST(bentleyOttmann, TestIsectCrosshatch03) {
std::vector<LineSegmentR> lines = {
LineSegmentR({Rational(-87,125),Rational(-123,250)},{Rational(247,500),Rational(349,500)}),
LineSegmentR({Rational(4,25),Rational(4,5)},{Rational(4,25),Rational(-4,5)}),
LineSegmentR({Rational(6,25),Rational(4,5)},{Rational(6,25),Rational(-4,5)}),
LineSegmentR({Rational(14,25),Rational(4,5)},{Rational(14,25),Rational(-4,5)}),
LineSegmentR({Rational(-87,125),Rational(-281,500)},{Rational(141,250),Rational(349,500)}),
LineSegmentR({Rational(88,125),Rational(17,250)},{Rational(-33,500),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(-1,500)},{Rational(1,250),Rational(-351,500)}),
LineSegmentR({Rational(37,500),Rational(-351,500)},{Rational(88,125),Rational(-9,125)}),
LineSegmentR({Rational(88,125),Rational(-71,500)},{Rational(18,125),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(-53,250)},{Rational(107,500),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(-141,500)},{Rational(71,250),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(-44,125)},{Rational(177,500),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(-211,500)},{Rational(53,125),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(-123,250)},{Rational(247,500),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(-281,500)},{Rational(141,250),Rational(-351,500)}),
LineSegmentR({Rational(-151,250),Rational(541,1000)},{Rational(67,125),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(361,1000)},{Rational(89,250),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(301,1000)},{Rational(37,125),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(241,1000)},{Rational(59,250),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(-539,1000)},{Rational(-68,125),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(-359,1000)},{Rational(-91,250),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(-299,1000)},{Rational(-38,125),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(-239,1000)},{Rational(-61,250),Rational(-599,1000)}),
LineSegmentR({Rational(-8,125),Rational(-599,1000)},{Rational(-151,250),Rational(-59,1000)}),
LineSegmentR({Rational(-151,250),Rational(1,1000)},{Rational(-1,250),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(61,1000)},{Rational(7,125),Rational(-599,1000)}),
LineSegmentR({Rational(16,25),Rational(4,5)},{Rational(16,25),Rational(-4,5)}),
LineSegmentR({Rational(-16,25),Rational(4,5)},{Rational(-16,25),Rational(-4,5)}),
LineSegmentR({Rational(-14,25),Rational(4,5)},{Rational(-14,25),Rational(-4,5)}),
LineSegmentR({Rational(-6,25),Rational(4,5)},{Rational(-6,25),Rational(-4,5)}),
LineSegmentR({Rational(-4,25),Rational(4,5)},{Rational(-4,25),Rational(-4,5)}),
LineSegmentR({Rational(4,5),Rational(4,5)},{Rational(4,5),Rational(-4,5)}),
LineSegmentR({Rational(-4,5),Rational(4,5)},{Rational(-4,5),Rational(-4,5)}),
LineSegmentR({Rational(2,25),Rational(4,5)},{Rational(2,25),Rational(-4,5)}),
LineSegmentR({Rational(8,25),Rational(4,5)},{Rational(8,25),Rational(-4,5)}),
LineSegmentR({Rational(2,5),Rational(4,5)},{Rational(2,5),Rational(-4,5)}),
LineSegmentR({Rational(12,25),Rational(4,5)},{Rational(12,25),Rational(-4,5)}),
LineSegmentR({Rational(18,25),Rational(4,5)},{Rational(18,25),Rational(-4,5)}),
LineSegmentR({Rational(-18,25),Rational(4,5)},{Rational(-18,25),Rational(-4,5)}),
LineSegmentR({Rational(-12,25),Rational(4,5)},{Rational(-12,25),Rational(-4,5)}),
LineSegmentR({Rational(-2,5),Rational(4,5)},{Rational(-2,5),Rational(-4,5)}),
LineSegmentR({Rational(-8,25),Rational(4,5)},{Rational(-8,25),Rational(-4,5)}),
LineSegmentR({Rational(-2,25),Rational(4,5)},{Rational(-2,25),Rational(-4,5)}),
LineSegmentR({Rational(0,1),Rational(4,5)},{Rational(0,1),Rational(-4,5)}),
LineSegmentR({Rational(88,125),Rational(-79,125)},{Rational(317,500),Rational(-351,500)}),
LineSegmentR({Rational(-151,250),Rational(601,1000)},{Rational(149,250),Rational(-599,1000)}),
LineSegmentR({Rational(149,250),Rational(-539,1000)},{Rational(-68,125),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(-359,1000)},{Rational(-91,250),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(-299,1000)},{Rational(-38,125),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(-239,1000)},{Rational(-61,250),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(541,1000)},{Rational(67,125),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(361,1000)},{Rational(89,250),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(301,1000)},{Rational(37,125),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(241,1000)},{Rational(59,250),Rational(601,1000)}),
LineSegmentR({Rational(7,125),Rational(601,1000)},{Rational(149,250),Rational(61,1000)}),
LineSegmentR({Rational(149,250),Rational(1,1000)},{Rational(-1,250),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(-59,1000)},{Rational(-8,125),Rational(601,1000)}),
LineSegmentR({Rational(-151,250),Rational(481,1000)},{Rational(119,250),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(421,1000)},{Rational(52,125),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(181,1000)},{Rational(22,125),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(121,1000)},{Rational(29,250),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(-479,1000)},{Rational(-121,250),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(-419,1000)},{Rational(-53,125),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(-179,1000)},{Rational(-23,125),Rational(-599,1000)}),
LineSegmentR({Rational(-151,250),Rational(-119,1000)},{Rational(-31,250),Rational(-599,1000)}),
LineSegmentR({Rational(149,250),Rational(-479,1000)},{Rational(-121,250),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(-419,1000)},{Rational(-53,125),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(-179,1000)},{Rational(-23,125),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(-119,1000)},{Rational(-31,250),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(421,1000)},{Rational(52,125),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(121,1000)},{Rational(29,250),Rational(601,1000)}),
LineSegmentR({Rational(88,125),Rational(69,500)},{Rational(-17,125),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(26,125)},{Rational(-103,500),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(139,500)},{Rational(-69,250),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(87,250)},{Rational(-173,500),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(209,500)},{Rational(-52,125),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(61,125)},{Rational(-243,500),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(279,500)},{Rational(-139,250),Rational(-351,500)}),
LineSegmentR({Rational(88,125),Rational(157,250)},{Rational(-313,500),Rational(-351,500)}),
LineSegmentR({Rational(149,250),Rational(481,1000)},{Rational(119,250),Rational(601,1000)}),
LineSegmentR({Rational(149,250),Rational(181,1000)},{Rational(22,125),Rational(601,1000)}),
LineSegmentR({Rational(9,10),Rational(27,100)},{Rational(-9,10),Rational(27,100)}),
LineSegmentR({Rational(9,10),Rational(18,25)},{Rational(-9,10),Rational(18,25)}),
LineSegmentR({Rational(9,10),Rational(9,10)},{Rational(-9,10),Rational(9,10)}),
LineSegmentR({Rational(9,10),Rational(0,1)},{Rational(-9,10),Rational(0,1)}),
LineSegmentR({Rational(9,10),Rational(9,100)},{Rational(-9,10),Rational(9,100)}),
LineSegmentR({Rational(9,10),Rational(9,50)},{Rational(-9,10),Rational(9,50)}),
LineSegmentR({Rational(9,10),Rational(9,25)},{Rational(-9,10),Rational(9,25)}),
LineSegmentR({Rational(9,10),Rational(9,20)},{Rational(-9,10),Rational(9,20)}),
LineSegmentR({Rational(9,10),Rational(27,50)},{Rational(-9,10),Rational(27,50)}),
LineSegmentR({Rational(9,10),Rational(63,100)},{Rational(-9,10),Rational(63,100)}),
LineSegmentR({Rational(9,10),Rational(81,100)},{Rational(-9,10),Rational(81,100)}),
LineSegmentR({Rational(9,10),Rational(-9,10)},{Rational(-9,10),Rational(-9,10)}),
LineSegmentR({Rational(9,10),Rational(-81,100)},{Rational(-9,10),Rational(-81,100)}),
LineSegmentR({Rational(9,10),Rational(-18,25)},{Rational(-9,10),Rational(-18,25)}),
LineSegmentR({Rational(9,10),Rational(-63,100)},{Rational(-9,10),Rational(-63,100)}),
LineSegmentR({Rational(9,10),Rational(-27,50)},{Rational(-9,10),Rational(-27,50)}),
LineSegmentR({Rational(9,10),Rational(-9,20)},{Rational(-9,10),Rational(-9,20)}),
LineSegmentR({Rational(9,10),Rational(-9,25)},{Rational(-9,10),Rational(-9,25)}),
LineSegmentR({Rational(9,10),Rational(-27,100)},{Rational(-9,10),Rational(-27,100)}),
LineSegmentR({Rational(9,10),Rational(-9,50)},{Rational(-9,10),Rational(-9,50)}),
LineSegmentR({Rational(9,10),Rational(-9,100)},{Rational(-9,10),Rational(-9,100)}),
LineSegmentR({Rational(-87,125),Rational(-53,250)},{Rational(107,500),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(-71,500)},{Rational(18,125),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(61,125)},{Rational(-243,500),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(69,500)},{Rational(-17,125),Rational(349,500)}),
LineSegmentR({Rational(88,125),Rational(349,500)},{Rational(-87,125),Rational(-351,500)}),
LineSegmentR({Rational(-87,125),Rational(-79,125)},{Rational(317,500),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(-211,500)},{Rational(53,125),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(-44,125)},{Rational(177,500),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(-141,500)},{Rational(71,250),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(157,250)},{Rational(-313,500),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(279,500)},{Rational(-139,250),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(209,500)},{Rational(-52,125),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(87,250)},{Rational(-173,500),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(139,500)},{Rational(-69,250),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(26,125)},{Rational(-103,500),Rational(349,500)}),
LineSegmentR({Rational(-33,500),Rational(349,500)},{Rational(-87,125),Rational(17,250)}),
LineSegmentR({Rational(-87,125),Rational(-1,500)},{Rational(1,250),Rational(349,500)}),
LineSegmentR({Rational(-87,125),Rational(-9,125)},{Rational(37,500),Rational(349,500)}),
};
std::vector<PointR> intersections = getIntersectionsBrute(lines);
auto events = bentleyOttmann(lines);
std::vector<PointR> results;
for (const auto& event : events)
	results.push_back(event.first);
EXPECT_THAT(results, UnorderedElementsAreArray(intersections));
}

TEST(bentleyOttmann, TestIsectCrosshatch04) {
std::vector<LineSegmentR> lines = {
LineSegmentR({Rational(-23219,1000000),Rational(781679,1000000)},{Rational(-66621,100000),Rational(410447,1000000)}),
LineSegmentR({Rational(-385441,1000000),Rational(54921,62500)},{Rational(-569153,1000000),Rational(77267,100000)}),
LineSegmentR({Rational(1969,40000),Rational(762267,1000000)},{Rational(-342811,500000),Rational(338003,1000000)}),
LineSegmentR({Rational(-312997,1000000),Rational(214831,250000)},{Rational(-147141,250000),Rational(28009,40000)}),
LineSegmentR({Rational(339003,1000000),Rational(684621,1000000)},{Rational(-763267,1000000),Rational(1929,40000)}),
LineSegmentR({Rational(51431,125000),Rational(66521,100000)},{Rational(-782679,1000000),Rational(-24219,1000000)}),
LineSegmentR({Rational(28049,40000),Rational(146891,250000)},{Rational(-215081,250000),Rational(-313997,1000000)}),
LineSegmentR({Rational(77367,100000),Rational(568153,1000000)},{Rational(-109967,125000),Rational(-386441,1000000)}),
LineSegmentR({Rational(-1969,40000),Rational(-764267,1000000)},{Rational(685621,1000000),Rational(-340003,1000000)}),
LineSegmentR({Rational(23219,1000000),Rational(-783679,1000000)},{Rational(66621,100000),Rational(-12889,31250)}),
LineSegmentR({Rational(312997,1000000),Rational(-215331,250000)},{Rational(147141,250000),Rational(-351113,500000)}),
LineSegmentR({Rational(385441,1000000),Rational(-27523,31250)},{Rational(569153,1000000),Rational(-77467,100000)}),
LineSegmentR({Rational(-339003,1000000),Rational(-686621,1000000)},{Rational(763267,1000000),Rational(-25113,500000)}),
LineSegmentR({Rational(-51431,125000),Rational(-66721,100000)},{Rational(782679,1000000),Rational(22219,1000000)}),
LineSegmentR({Rational(-28049,40000),Rational(-147391,250000)},{Rational(215081,250000),Rational(311997,1000000)}),
LineSegmentR({Rational(-77367,100000),Rational(-570153,1000000)},{Rational(109967,125000),Rational(384441,1000000)}),
LineSegmentR({Rational(266559,1000000),Rational(704033,1000000)},{Rational(-46491,62500),Rational(12067,100000)}),
LineSegmentR({Rational(97057,500000),Rational(180861,250000)},{Rational(-181111,250000),Rational(96557,500000)}),
LineSegmentR({Rational(-705033,1000000),Rational(265559,1000000)},{Rational(12167,100000),Rational(92857,125000)}),
LineSegmentR({Rational(-95663,1000000),Rational(80109,100000)},{Rational(-646799,1000000),Rational(120723,250000)}),
LineSegmentR({Rational(-42027,250000),Rational(410251,500000)},{Rational(-627387,1000000),Rational(555337,1000000)}),
LineSegmentR({Rational(-30069,125000),Rational(839913,1000000)},{Rational(-75997,125000),Rational(627781,1000000)}),
LineSegmentR({Rational(-228943,500000),Rational(898147,1000000)},{Rational(-549741,1000000),Rational(422557,500000)}),
LineSegmentR({Rational(120973,250000),Rational(645799,1000000)},{Rational(-80209,100000),Rational(-96663,1000000)}),
LineSegmentR({Rational(556337,1000000),Rational(626387,1000000)},{Rational(-410751,500000),Rational(-42277,250000)}),
LineSegmentR({Rational(628781,1000000),Rational(9484,15625)},{Rational(-840913,1000000),Rational(-15097,62500)}),
LineSegmentR({Rational(423057,500000),Rational(548741,1000000)},{Rational(-899147,1000000),Rational(-229443,500000)}),
LineSegmentR({Rational(-918559,1000000),Rational(-53133,100000)},{Rational(918559,1000000),Rational(52933,100000)}),
LineSegmentR({Rational(-266559,1000000),Rational(-706033,1000000)},{Rational(46491,62500),Rational(-12267,100000)}),
LineSegmentR({Rational(-97057,500000),Rational(-181361,250000)},{Rational(181111,250000),Rational(-97557,500000)}),
LineSegmentR({Rational(705033,1000000),Rational(-267559,1000000)},{Rational(-12167,100000),Rational(-93107,125000)}),
LineSegmentR({Rational(95663,1000000),Rational(-80309,100000)},{Rational(646799,1000000),Rational(-121223,250000)}),
LineSegmentR({Rational(42027,250000),Rational(-411251,500000)},{Rational(627387,1000000),Rational(-557337,1000000)}),
LineSegmentR({Rational(30069,125000),Rational(-841913,1000000)},{Rational(75997,125000),Rational(-629781,1000000)}),
LineSegmentR({Rational(228943,500000),Rational(-900147,1000000)},{Rational(549741,1000000),Rational(-423557,500000)}),
LineSegmentR({Rational(-120973,250000),Rational(-647799,1000000)},{Rational(80209,100000),Rational(94663,1000000)}),
LineSegmentR({Rational(-556337,1000000),Rational(-628387,1000000)},{Rational(410751,500000),Rational(41777,250000)}),
LineSegmentR({Rational(-628781,1000000),Rational(-38061,62500)},{Rational(840913,1000000),Rational(3743,15625)}),
LineSegmentR({Rational(-423057,500000),Rational(-550741,1000000)},{Rational(899147,1000000),Rational(228443,500000)}),
LineSegmentR({Rational(-9,40),Rational(3,4)},{Rational(-9,40),Rational(-3,4)}),
LineSegmentR({Rational(-3,5),Rational(3,4)},{Rational(-3,5),Rational(-3,4)}),
LineSegmentR({Rational(-3,4),Rational(3,4)},{Rational(-3,4),Rational(-3,4)}),
LineSegmentR({Rational(0,1),Rational(3,4)},{Rational(0,1),Rational(-3,4)}),
LineSegmentR({Rational(-3,40),Rational(3,4)},{Rational(-3,40),Rational(-3,4)}),
LineSegmentR({Rational(-3,20),Rational(3,4)},{Rational(-3,20),Rational(-3,4)}),
LineSegmentR({Rational(-3,10),Rational(3,4)},{Rational(-3,10),Rational(-3,4)}),
LineSegmentR({Rational(-3,8),Rational(3,4)},{Rational(-3,8),Rational(-3,4)}),
LineSegmentR({Rational(-9,20),Rational(3,4)},{Rational(-9,20),Rational(-3,4)}),
LineSegmentR({Rational(-21,40),Rational(3,4)},{Rational(-21,40),Rational(-3,4)}),
LineSegmentR({Rational(-27,40),Rational(3,4)},{Rational(-27,40),Rational(-3,4)}),
LineSegmentR({Rational(3,4),Rational(3,4)},{Rational(3,4),Rational(-3,4)}),
LineSegmentR({Rational(27,40),Rational(3,4)},{Rational(27,40),Rational(-3,4)}),
LineSegmentR({Rational(3,5),Rational(3,4)},{Rational(3,5),Rational(-3,4)}),
LineSegmentR({Rational(21,40),Rational(3,4)},{Rational(21,40),Rational(-3,4)}),
LineSegmentR({Rational(9,20),Rational(3,4)},{Rational(9,20),Rational(-3,4)}),
LineSegmentR({Rational(3,8),Rational(3,4)},{Rational(3,8),Rational(-3,4)}),
LineSegmentR({Rational(3,10),Rational(3,4)},{Rational(3,10),Rational(-3,4)}),
LineSegmentR({Rational(9,40),Rational(3,4)},{Rational(9,40),Rational(-3,4)}),
LineSegmentR({Rational(3,20),Rational(3,4)},{Rational(3,20),Rational(-3,4)}),
LineSegmentR({Rational(3,40),Rational(3,4)},{Rational(3,40),Rational(-3,4)}),
LineSegmentR({Rational(-373573,500000),Rational(66367,1000000)},{Rational(373573,500000),Rational(-64367,1000000)}),
LineSegmentR({Rational(-753683,1000000),Rational(-2087,250000)},{Rational(740609,1000000),Rational(-139081,1000000)}),
LineSegmentR({Rational(-773293,1000000),Rational(-58123,250000)},{Rational(720999,1000000),Rational(-14529,40000)}),
LineSegmentR({Rational(-779829,1000000),Rational(-153603,500000)},{Rational(714463,1000000),Rational(-21897,50000)}),
LineSegmentR({Rational(-393183,500000),Rational(-381921,1000000)},{Rational(353963,500000),Rational(-256327,500000)}),
LineSegmentR({Rational(-100747,125000),Rational(-121213,200000)},{Rational(172079,250000),Rational(-368399,500000)}),
LineSegmentR({Rational(-172079,250000),Rational(369399,500000)},{Rational(100747,125000),Rational(121613,200000)}),
LineSegmentR({Rational(-353963,500000),Rational(257327,500000)},{Rational(393183,500000),Rational(383921,1000000)}),
LineSegmentR({Rational(-714463,1000000),Rational(21997,50000)},{Rational(779829,1000000),Rational(154603,500000)}),
LineSegmentR({Rational(-720999,1000000),Rational(14609,40000)},{Rational(773293,1000000),Rational(58623,250000)}),
LineSegmentR({Rational(-740609,1000000),Rational(141081,1000000)},{Rational(753683,1000000),Rational(2587,250000)}),
LineSegmentR({Rational(-812513,1000000),Rational(-680779,1000000)},{Rational(681779,1000000),Rational(-811513,1000000)}),
LineSegmentR({Rational(-681779,1000000),Rational(813513,1000000)},{Rational(812513,1000000),Rational(682779,1000000)}),
LineSegmentR({Rational(-760219,1000000),Rational(-83063,1000000)},{Rational(734073,1000000),Rational(-53449,250000)}),
LineSegmentR({Rational(-191689,250000),Rational(-157777,1000000)},{Rational(45471,62500),Rational(-288511,1000000)}),
LineSegmentR({Rational(-792903,1000000),Rational(-114159,250000)},{Rational(701389,1000000),Rational(-587369,1000000)}),
LineSegmentR({Rational(-9993,12500),Rational(-10627,20000)},{Rational(173713,250000),Rational(-165521,250000)}),
LineSegmentR({Rational(-173713,250000),Rational(664083,1000000)},{Rational(799439,1000000),Rational(10667,20000)}),
LineSegmentR({Rational(-701389,1000000),Rational(589369,1000000)},{Rational(792903,1000000),Rational(91727,200000)}),
LineSegmentR({Rational(-45471,62500),Rational(29051,100000)},{Rational(191689,250000),Rational(159777,1000000)}),
LineSegmentR({Rational(-734073,1000000),Rational(53949,250000)},{Rational(760219,1000000),Rational(42531,500000)}),
LineSegmentR({Rational(-534509,1000000),Rational(427909,500000)},{Rational(621393,1000000),Rational(-794981,1000000)}),
LineSegmentR({Rational(-57581,125000),Rational(168559,200000)},{Rational(634417,1000000),Rational(-721121,1000000)}),
LineSegmentR({Rational(-96697,250000),Rational(829771,1000000)},{Rational(8093,12500),Rational(-32363,50000)}),
LineSegmentR({Rational(-312927,1000000),Rational(816747,1000000)},{Rational(41279,62500),Rational(-2867,5000)}),
LineSegmentR({Rational(-239067,1000000),Rational(200931,250000)},{Rational(42093,62500),Rational(-499539,1000000)}),
LineSegmentR({Rational(-82603,500000),Rational(7907,10000)},{Rational(686511,1000000),Rational(-425679,1000000)}),
LineSegmentR({Rational(-45673,500000),Rational(777677,1000000)},{Rational(139907,200000),Rational(-175909,500000)}),
LineSegmentR({Rational(-3497,200000),Rational(764653,1000000)},{Rational(712559,1000000),Rational(-138979,500000)}),
LineSegmentR({Rational(794981,1000000),Rational(621393,1000000)},{Rational(427909,500000),Rational(534509,1000000)}),
LineSegmentR({Rational(721121,1000000),Rational(634417,1000000)},{Rational(168559,200000),Rational(57581,125000)}),
LineSegmentR({Rational(32363,50000),Rational(8093,12500)},{Rational(829771,1000000),Rational(96697,250000)}),
LineSegmentR({Rational(2867,5000),Rational(41279,62500)},{Rational(816747,1000000),Rational(312927,1000000)}),
LineSegmentR({Rational(499539,1000000),Rational(42093,62500)},{Rational(200931,250000),Rational(239067,1000000)}),
LineSegmentR({Rational(425679,1000000),Rational(686511,1000000)},{Rational(7907,10000),Rational(82603,500000)}),
LineSegmentR({Rational(175909,500000),Rational(139907,200000)},{Rational(777677,1000000),Rational(18269,200000)}),
LineSegmentR({Rational(277957,1000000),Rational(712559,1000000)},{Rational(764653,1000000),Rational(3497,200000)}),
LineSegmentR({Rational(751629,1000000),Rational(-7047,125000)},{Rational(204097,1000000),Rational(362791,500000)}),
LineSegmentR({Rational(32559,250000),Rational(369303,500000)},{Rational(369303,500000),Rational(-32559,250000)}),
LineSegmentR({Rational(7047,125000),Rational(751629,1000000)},{Rational(362791,500000),Rational(-204097,1000000)}),
LineSegmentR({Rational(57581,125000),Rational(-168559,200000)},{Rational(-634417,1000000),Rational(721121,1000000)}),
LineSegmentR({Rational(96697,250000),Rational(-829771,1000000)},{Rational(-647441,1000000),Rational(32363,50000)}),
LineSegmentR({Rational(45673,500000),Rational(-777677,1000000)},{Rational(-139907,200000),Rational(175909,500000)}),
LineSegmentR({Rational(3497,200000),Rational(-764653,1000000)},{Rational(-712559,1000000),Rational(277957,1000000)}),
LineSegmentR({Rational(-32363,50000),Rational(-8093,12500)},{Rational(-829771,1000000),Rational(-96697,250000)}),
LineSegmentR({Rational(-277957,1000000),Rational(-712559,1000000)},{Rational(-764653,1000000),Rational(-3497,200000)}),
LineSegmentR({Rational(-60837,100000),Rational(434421,500000)},{Rational(60837,100000),Rational(-434421,500000)}),
LineSegmentR({Rational(534509,1000000),Rational(-427909,500000)},{Rational(-621393,1000000),Rational(794981,1000000)}),
LineSegmentR({Rational(312927,1000000),Rational(-816747,1000000)},{Rational(-41279,62500),Rational(2867,5000)}),
LineSegmentR({Rational(239067,1000000),Rational(-200931,250000)},{Rational(-42093,62500),Rational(499539,1000000)}),
LineSegmentR({Rational(82603,500000),Rational(-7907,10000)},{Rational(-686511,1000000),Rational(425679,1000000)}),
LineSegmentR({Rational(-794981,1000000),Rational(-621393,1000000)},{Rational(-427909,500000),Rational(-534509,1000000)}),
LineSegmentR({Rational(-721121,1000000),Rational(-634417,1000000)},{Rational(-168559,200000),Rational(-460649,1000000)}),
LineSegmentR({Rational(-2867,5000),Rational(-41279,62500)},{Rational(-816747,1000000),Rational(-312927,1000000)}),
LineSegmentR({Rational(-499539,1000000),Rational(-42093,62500)},{Rational(-200931,250000),Rational(-239067,1000000)}),
LineSegmentR({Rational(-425679,1000000),Rational(-686511,1000000)},{Rational(-7907,10000),Rational(-82603,500000)}),
LineSegmentR({Rational(-175909,500000),Rational(-139907,200000)},{Rational(-777677,1000000),Rational(-45673,500000)}),
LineSegmentR({Rational(-751629,1000000),Rational(7047,125000)},{Rational(-204097,1000000),Rational(-362791,500000)}),
LineSegmentR({Rational(-32559,250000),Rational(-369303,500000)},{Rational(-369303,500000),Rational(32559,250000)}),
LineSegmentR({Rational(-7047,125000),Rational(-751629,1000000)},{Rational(-362791,500000),Rational(204097,1000000)}),
};
std::vector<PointR> intersections = getIntersectionsBrute(lines);
auto events = bentleyOttmann(lines);
std::vector<PointR> results;
for (const auto& event : events)
	results.push_back(event.first);
EXPECT_THAT(results, UnorderedElementsAreArray(intersections));
}

TEST(bentleyOttmann, TestIsectCross01) {
std::vector<LineSegmentR> lines = {
LineSegmentR({Rational(1,1),Rational(0,1)},{Rational(-1,1),Rational(0,1)}),
LineSegmentR({Rational(0,1),Rational(1,1)},{Rational(0,1),Rational(-1,1)}),
};
std::vector<PointR> intersections = getIntersectionsBrute(lines);
auto events = bentleyOttmann(lines);
std::vector<PointR> results;
for (const auto& event : events)
	results.push_back(event.first);
EXPECT_THAT(results, UnorderedElementsAreArray(intersections));
}